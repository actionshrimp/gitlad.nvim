- [x] do we have tests that check the actual git config values are being updated in the file correctly? if not can we add some
- [x] when the upstream is changed, can we force a refresh of the git state, as the status window is highly dependent on that config
- [x] better 'q' behaviour and buffer tracking
- [x] when reopening status buffer, position cursor at first item (not header)
- [x] discard hunks with 'x' - we can discard whole files but this should also work at hunk level
- [x] "diffs" / pressing RET on stashes doesnt seem to work. Does diffview support this?
- [x] update casing of 'pushremote' in places where it's all lower case to 'pushRemote'
- [x] is there some way we can make partial staging of untracked files work? perhaps with `git add -N` followed by a similar approach to how we do staging of visually selected lines for unstaged changes?
- [x] add 'o' to push popup (push other branch)
- [x] 'no upstream configured for main, cannot spin off'
- [x] configurable status buffer sections: allow users to configure the order and presence of different sections (staged, unstaged, untracked, worktrees, stashes, etc.) - some users may not want certain sections shown or may prefer them at different positions. Could also include section-specific options like 'number of recent commits' to display.
- [x] Can we add a 'view is stale' indicator? I dont want it to actually ever interrupt what the user is doing, but if we async detect the git state has changed, we should update our 'idle/loading' header (which shows the spinner) to some kind of alert state to prompt the user to do a manual refresh. this might be a good case for an actual background/file watcher as an initial test run. but this should be configurable, some users may not want it turned on.
- [x] Weird highlighting issue where line highlighting somehow gets enabled and line numbers disappear - this is actually my themes 'terminal' styles and nvim's default behaviour to open new files in buffers other than `nofile` buffers. need to adapt workflow
- [x] something is a bit off when staging an entirely new (previously untracked) directory - we just see the dir staged and not the individual files, which show up as hunks for some reason. we _do_ expect to see just the directory name in the 'untracked' section, but when staged it should expand to the individual files
- [x] display of renamed files could be better, using the /common/path/to/{suba/a.txt -> subb/b.txt} style
- [x] git rebase continue fails if there are conflicts and you need to confirm the updated commit message (with Conflicts: section) - not implemented
- [x] worktree 'sibling' strat - can we make it default to `../branch-name` rather than `_branch-name`? what does magit do?
- [x] when confirming an edit after a rebase conflict, we should go back to the status window and not the empty buffer
- [x] are our worktree popup keys the same as magit evil collection?
- [x] still a slight issue with our new 'intent to add' feature and the staging of a new directory ;(
- [x] can we render ansi terminal colour codes nicely in the hook popup output?
- [x] why is 'origin' listed as a ref under the origin remote in our version?
- [x] overall visual improvements to refs view - see screenshots of magit's (polished, colourful, more detail about remote's details) vs ours
- [x] remove the help text at the bottom of the refs view, and just say 'press ? for help' like in the status view. but show the keys which are relevant to the refs view in there
- [x] when running `SPC p t` from status buffer i get an error as neovim doesnt think it's a real project directory - fixed by fixing my own neovim config
- [x] from refs view, I'd also like to standardise the diff popup to behave the same as other views. however it should use the context under the point to help the user build a range expression, with a full initial suggestion. essentially the flow should be:
    - type `d r`, get a popup with a default range suggested based on the context (use magit's examples here)
    - in that same popup, allow the user to also type in an arbitrary range if they know what they're doing
    - add a second suggestion 'Build range', which if selected starts a 3-popup that guides the user through building a range: 1) base ref from refs picker (with arbitrary input supported too), 2) choice between `..` and `...`, 3) other ref from refs picker (with arbitrary input supported too).
    - This should be the most flexible but help the user build ranges more easily if needed
- [x] improve look and feel of '$' / command history (from screenshot)
- [x] we should highlight long-form flag arguments in popups when selected, rather than showing a * at the start
- [x] unstage new files from unstaged back to untracked doesnt work with visual selection (confirmed fixed)
- [x] for a moved file, only show the actual file changes in the diff
- [x] hitting discard on an untracked directory gives an error - it should be possible to delete the whole directory (with a confirmation though!)
- [x] setting upstream to a local branch doesnt work properly (couldn't repro this actually?)
- [x] applying a patch
- [x] stage some changes, tab to expand and check them. commit. after refresh, cursor is now on stashes. press p to push but it pops the stash instead
- [ ] some kind of display of queued git operations so you know git is still working underneath for slow operations?
- [ ] hook output window should only appear if hooks are actually configured. Before implementing, consider a holistic approach: detect configured hooks and show progress/output for all git operations that may trigger them (commit, push, etc.). This may warrant a dedicated phase in PLAN.md.
- [ ] implement the rebase todo list as per magit
